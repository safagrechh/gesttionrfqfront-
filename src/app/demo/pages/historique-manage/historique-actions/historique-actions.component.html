<div class="row">
  <div class="col-sm-12">
    <app-card cardTitle="Historique des Actions" [options]="false">
      <form [formGroup]="filterForm" class="mb-3">
        <div class="row g-3 align-items-end">
          <div class="col-md-3">
            <label class="form-label" for="startDate">Date début</label>
            <input id="startDate" type="date" class="form-control" formControlName="startDate" />
          </div>
          <div class="col-md-3">
            <label class="form-label" for="endDate">Date fin</label>
            <input id="endDate" type="date" class="form-control" formControlName="endDate" />
          </div>
          <div class="col-md-2">
            <label class="form-label" for="cq">CQ</label>
            <input id="cq" type="number" class="form-control" formControlName="cq" />
          </div>
          <div class="col-md-3">
            <label class="form-label" for="userId">Utilisateur</label>
            <select id="userId" class="form-control" formControlName="userId">
              <option value="">-- Tous --</option>
              <option *ngFor="let u of users" [value]="u.id">{{ u.nomUser }}</option>
            </select>
          </div>
          <div class="col-md-12 d-flex gap-2">
            <button type="button" class="btn btn-primary" (click)="applyFilter()">
              <i class="feather icon-filter"></i> Filtrer
            </button>
            <button type="button" class="btn btn-outline-secondary" (click)="resetFilters()">
              <i class="feather icon-refresh-ccw"></i> Réinitialiser
            </button>
          </div>
        </div>
      </form>

      <div *ngIf="loading" class="alert alert-info">Chargement...</div>
      <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

      <div class="table-responsive" *ngIf="!loading && actions.length > 0">
        <table class="table table-hover mb-0">
          <thead>
            <tr>
              <th>Date</th>
              <th>Utilisateur</th>
              <th>Type</th>
              <th>Cible</th>
              <th>Référence</th>
              <th>Détails</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let a of actions; trackBy: trackById">
              <td>{{ formatDate(a.dateAction) }}</td>
              <td>{{ a.userName }}</td>
              <td>{{ a.type }}</td>
              <td>{{ a.cibleAction }}</td>
              <td>{{ a.referenceCible }}</td>
              <td>{{ a.detailsAction }}</td>
            </tr>
          </tbody>
        </table>
      </div>
      <p *ngIf="!loading && actions.length === 0" class="text-muted">Aucune action trouvée.</p>
    </app-card>
  </div>
</div>